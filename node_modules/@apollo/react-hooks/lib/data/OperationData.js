import { isEqual } from 'apollo-utilities';
import { invariant } from 'ts-invariant';
import { parser, operationName } from '@apollo/react-common';
var OperationData = (function () {
    function OperationData(options, context) {
        this._isMounted = true;
        this._options = {};
        this._previousOptions = {};
        this._context = {};
        this._options = options || {};
        this._context = context || {};
    }
    Object.defineProperty(OperationData.prototype, "isMounted", {
        get: function () {
            return this._isMounted;
        },
        set: function (mounted) {
            this._isMounted = mounted;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OperationData.prototype, "options", {
        get: function () {
            return this._options;
        },
        set: function (newOptions) {
            if (!isEqual(this.options, newOptions)) {
                this.previousOptions = this.options;
            }
            this._options = newOptions;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OperationData.prototype, "previousOptions", {
        get: function () {
            return this._previousOptions;
        },
        set: function (newOptions) {
            this._previousOptions = newOptions;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OperationData.prototype, "context", {
        get: function () {
            return this._context;
        },
        set: function (newContext) {
            this._context = newContext;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(OperationData.prototype, "client", {
        get: function () {
            return this._client;
        },
        set: function (newClient) {
            this._client = newClient;
        },
        enumerable: true,
        configurable: true
    });
    OperationData.prototype.unmount = function () {
        this.isMounted = false;
    };
    OperationData.prototype.refreshClient = function () {
        var client = (this.options && this.options.client) ||
            (this.context && this.context.client);
        invariant(!!client, 'Could not find "client" in the context or passed in as an option. ' +
            'Wrap the root component in an <ApolloProvider>, or pass an ' +
            'ApolloClient instance in via options.');
        var isNew = false;
        if (client !== this.client) {
            isNew = true;
            this.client = client;
            this.cleanup();
        }
        return {
            client: this.client,
            isNew: isNew
        };
    };
    OperationData.prototype.verifyDocumentType = function (document, type) {
        var operation = parser(document);
        var requiredOperationName = operationName(type);
        var usedOperationName = operationName(operation.type);
        invariant(operation.type === type, "Running a " + requiredOperationName + " requires a graphql " +
            (requiredOperationName + ", but a " + usedOperationName + " was used instead."));
    };
    return OperationData;
}());
export { OperationData };
//# sourceMappingURL=OperationData.js.map